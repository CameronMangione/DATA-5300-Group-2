---
title: "Group Project 1"
author: "cameronjosephblackmangione"
output: html_document
date: "2025-10-26"
---
```{r}
library(dplyr)
library(ggplot2)
library(nycflights13)
library(readr)
library(curl)
library(tidyr)
library(fivethirtyeight)
library(tidyverse)
library(resampledata3)
library(moderndive)
library(readxl)
```

```{r}
weather
```
```{r}
flights
```
```{r}
flights_ua <- flights %>%
  filter(carrier == "UA") %>%
  filter(!is.na(dep_delay))
glimpse(flights_ua)
```
```{r}
weather_clean <- weather %>%
  filter(!is.na(wind_speed)) %>%
  filter(!is.na(temp)) %>%
  filter(!is.na(visib)) %>%
  filter(!is.na(precip))
glimpse(weather_clean)
```
```{r}
merged <- flights_ua %>%
  inner_join(weather_clean, by = c("year", "month", "day", "hour", "origin"))
glimpse(merged)
```

```{r}
merged <- merged %>%
  mutate(late = dep_delay > 0)
glimpse(merged)
```

```{r}
ggplot(data = merged, aes(x = temp, y = dep_delay))+
  geom_point(alpha = 0.7)
```
```{r}
ggplot(data = merged, aes(x = wind_gust, y = dep_delay))+
  geom_point(alpha = 0.7)
```
```{r}
ggplot(data = merged, aes(x = precip, y = dep_delay))+
  geom_point(alpha = 0.7)
```
```{r}
ggplot(data = merged, aes(x = visib, y = dep_delay))+
  geom_point(alpha = 0.7)
```

### Cameron worked on the precipitation data.
```{r}
merged_precip <- merged %>%
  filter(precip > 0)
glimpse(merged_precip)
```

```{r}
observed <- mean(merged_precip$precip[merged_precip$late == TRUE]) - mean(merged_precip$precip[merged_precip$late == FALSE])

N <- 10^4-1

sample.size = nrow(merged_precip)

group.1.size = nrow(merged_precip[merged_precip$late == TRUE,])

result <- numeric(N)

for (i in 1:N)
{
  index = sample(sample.size, size = group.1.size, replace=FALSE)
  result[i] = mean(merged_precip$precip[index]) - mean(merged_precip$precip[-index])
}

ggplot(data = tibble(result), aes(x = result))+
  geom_histogram() + 
  geom_vline(xintercept = observed, color = "red")

observed
2*(sum(result >= observed) +1) / (N+1)
```

```{r}
merged_visib <- merged %>%
  filter(visib < 10)
glimpse(merged_visib)
```

```{r}
observed <- mean(merged_visib$visib[merged_visib$late == TRUE]) - mean(merged_visib$visib[merged_visib$late == FALSE])

N <- 10^4-1

sample.size = nrow(merged_visib)

group.1.size = nrow(merged_visib[merged_visib$late == TRUE,])

result <- numeric(N)

for (i in 1:N)
{
  index = sample(sample.size, size = group.1.size, replace=FALSE)
  result[i] = mean(merged_visib$visib[index]) - mean(merged_visib$visib[-index])
}

ggplot(data = tibble(result), aes(x = result))+
  geom_histogram() + 
  geom_vline(xintercept = observed, color = "red")

observed
2*(sum(abs(result) >= observed) +1) / (N+1)
```

```{r}
observed <- mean(merged$temp[merged$late == TRUE]) - mean(merged$temp[merged$late == FALSE])

N <- 10^4-1

sample.size = nrow(merged)

group.1.size = nrow(merged[merged$late == TRUE,])

result <- numeric(N)

for (i in 1:N)
{
  index = sample(sample.size, size = group.1.size, replace=FALSE)
  result[i] = mean(merged$temp[index]) - mean(merged$temp[-index])
}

ggplot(data = tibble(result), aes(x = result))+
  geom_histogram() + 
  geom_vline(xintercept = observed, color = "red")

observed
2*(sum(result >= observed) +1) / (N+1)
```
```{r}
observed <- mean(merged$wind_speed[merged$late == TRUE]) - mean(merged$wind_speed[merged$late == FALSE])

N <- 10^4-1

sample.size = nrow(merged)

group.1.size = nrow(merged[merged$late == TRUE,])

result <- numeric(N)

for (i in 1:N)
{
  index = sample(sample.size, size = group.1.size, replace=FALSE)
  result[i] = mean(merged$wind_speed[index]) - mean(merged$wind_speed[-index])
}

ggplot(data = tibble(result), aes(x = result))+
  geom_histogram() + 
  geom_vline(xintercept = observed, color = "red")

observed
2*(sum(result >= observed) +1) / (N+1)
```






